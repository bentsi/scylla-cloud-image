#!/usr/bin/make -f

include /usr/share/dpkg/pkg-info.mk

override_dh_auto_build:

override_dh_auto_clean:

override_dh_auto_install:
	install -d -m755 $(CURDIR)/debian/tmp/opt/scylladb/scylla-machine-image/lib
	install -m644 lib/log.py $(CURDIR)/debian/tmp/opt/scylladb/scylla-machine-image/lib
	install -m755 common/scylla_configure.py common/scylla_create_devices $(CURDIR)/debian/tmp/opt/scylladb/scylla-machine-image
	./tools/relocate_python_scripts.py \
		--installroot $(CURDIR)/debian/tmp/opt/scylladb/scylla-machine-image/ \
		--with-python3 $(CURDIR)/debian/tmp/opt/scylladb/python3/bin/python3 \
	common/scylla_image_setup common/scylla_login common/scylla_configure.py \
	common/scylla_create_devices
	install -d -m755 $(CURDIR)/debian/tmp/home/ubuntu
	install -m755 common/.bash_profile $(CURDIR)/debian/tmp/home/ubuntu


override_dh_installinit:
	dh_installinit --no-start --name scylla-image-setup

override_dh_auto_test:

override_dh_strip_nondeterminism:

%:
	dh $@
